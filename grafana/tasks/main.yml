- name: Copy files from telebot host to target host using fetch+copy
  block:
    - name: Fetch files from telebot host to control node
      ansible.builtin.fetch:
        src: "{{ item.src }}"
        dest: "/tmp/fetched-{{ item.name }}"
        flat: yes
      delegate_to: telebot
      loop:
        - { src: "/tmp/grafana-gpg.key", name: "grafana-gpg.key" }
        - { src: "/tmp/grafana.deb", name: "grafana.deb" }
      when: not grafana_deb_file.stat.exists
      tags: [download]

    - name: Copy files from control node to target host
      ansible.builtin.copy:
        src: "/tmp/fetched-{{ item.name }}"
        dest: "{{ item.dest }}"
      loop:
        - { name: "grafana-gpg.key", dest: "/tmp/grafana-gpg.key" }
        - { name: "grafana.deb", dest: "/tmp/grafana.deb" }
      when: not grafana_deb_file.stat.exists
      tags: [download]